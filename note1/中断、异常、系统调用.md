## 中断、异常和系统调用工作关系图
<div align="center"> <img width="500px" src="https://github.com/sikaoreed/OS-NOTE/blob/master/note1/%E5%B7%A5%E4%BD%9C%E5%85%B3%E7%B3%BB%E5%9B%BE.png"/> </div>

## 中断、异常和系统调用比较
+ 源头
  + 中断：外设
  + 异常：应用程序或内核内部意象不到的行为
  + 系统调用：应用程序请求操作提供服务
+ 响应方式
  + 中断：异步（一般不影响应用程序的继续执行，应用程序不感知中断存在）
  + 异常：同步（处理完异常才可继续执行）
  + 系统调用：同步或者异步
+ 处理机制
  + 中断：持续，对用户应用程序是透明的
  + 异常：杀死或重新执行意想不到的应用程序指令
  + 系统调用：等待和持续（参考异步、同步）
## 中断处理机制（三种方式这里统称中断）
+ 硬件处理
  + 在 CPU 设置中断使能标志（是一项准备工作，许可 CPU 接受外界打扰前，CPU 不会对任何中断请求发出相应）
  + CPU 工作后，依据外部或内部事件设置中断标志
  + 依据中断向量调用相应中断服务例程  
  
+ 软件处理（内核软件）                                                                                                                    
**工作过程参考工作关系图**：首先进入中断向量表
  + 若是中断，直接进入中断服务例程，即设备驱动处，驱动程序做出响应
  + 若是异常，转到异常服务例程进行处理
  + 若是系统调用（系统调用量很大），需要借助系统调用表实现不同系统调用  
  
要实现上述机制，需要以下几种功能
1. 现场保存（编译器）
2. 中断服务处理（服务例程）
3. 清除中断标志（服务例程）
4. 现场恢复（编译器）  

1，4 维护上下文信息，使系统知道接下来干什么；2，3 由操作系统执行，进行中断处理。
## 中断嵌套
多个中断的处理机制，如：
+ 出现新中断，优先级高于当前中断，优先执行
+ 当前中断很重要，比如电池没电，拒绝其他任何中断
