# 计算机体系结构和内存层次
## 计算机体系结构
<div align="center"> <img width="500px" src="https://github.com/sikaoreed/OS-NOTE/blob/master/note2/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84.png"> </div>  

+ CPU
  + 寄存器：容量小，通常32位，64位寄存器，只能存几十字节或几百字节
  + 高速缓存：储存高频使用的数据，加快处理速度
  + 算术逻辑单元（ALU)：可实现加减乘除等四则运算，与、或、非、异或等逻辑运算，以及移位、求补等操作
  + 存储管理单元（MMU）：负责CPU的内存访问请求
+ 内存
  最小访问单位 8 bit，即1字节，而总线通常能读 32 位，即 4 字节  
  
## 内存层次
<div align="center"> <img width="500px" src="https://github.com/sikaoreed/OS-NOTE/blob/master/note2/%E5%86%85%E5%AD%98%E5%B1%82%E6%AC%A1.png"> </div> 

L1、L2 缓存由 MMU 控制，程序不能显式控制，内存访问及以下需要操作系统控制；层次间访问速度差异很大，最上最下相差百万倍数量级  

## 内存管理
<div align="center"> <img width="500px" src="https://github.com/sikaoreed/OS-NOTE/blob/master/note2/%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86.png"> </div>  
逻辑地址空间通过 MMU 映射为物理地址空间。通常操作系统代码存在内存，进程间随着切换的进行，存储在内存或外存里。  

+ **抽象**  
逻辑地址空间
+ **保护**  
独立地址空间（尽管物理地址空间可能连续，但不能相互干扰）
+ **共享**  
访问相同内存（操作系统代码段大部分一致，共享以提高效率）
+ **虚拟化**  
看起来逻辑空间大于物理内存总量
## 内存管理方式
1. 重定位
2. 分段  
如**程序**可分为代码，数据，堆栈三段，分开储存  
3. 分页  
分段以后每段需要的内存依然连续，此时可以**内存**分页  
4. 虚拟存储  
结合外存，通过操作系统对页的分配使得能使用的内存看起来大于实际内存（多数系统如 Linux 采用按需页式虚拟存储）
  

  
